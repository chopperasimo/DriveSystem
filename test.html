<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="robots" content="noindex,nofollow" />
  <title>GPS 位置表示 + 軌跡</title>
  <link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css" />
  <script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>
  <style>
    body, html { margin: 0; height: 100%; }
    #map { width: 100%; height: 100%; }
  </style>
</head>

<body>
  <div id="map"></div>

  <script>
    // ▼ 地図の初期化（適当な日本中央部）
    const map = L.map('map').setView([35.6812, 139.7671], 14);

    // ▼ 地理院地図（白地図）タイル
    L.tileLayer(
      "https://cyberjapandata.gsi.go.jp/xyz/pale/{z}/{x}/{y}.png",
      { maxZoom: 18, attribution: "地理院地図" }
    ).addTo(map);

    // ▼ マーカーと軌跡用の配列
    let marker = null;
    let pathLatLngs = [];
    let polyline = L.polyline([], {color: "red"}).addTo(map);

    // ▼ 位置情報を更新する関数
    function updateGPS() {
      navigator.geolocation.getCurrentPosition(
        (pos) => {
          const lat = pos.coords.latitude;
          const lng = pos.coords.longitude;

          // マーカーがなければ新規作成
          if (!marker) {
            marker = L.m
